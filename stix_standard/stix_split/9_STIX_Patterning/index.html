<!DOCTYPE html>
<html>
<head>
<base href="https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html"/>
<meta content="This document describes the STIX language for expressing cyber threat and observable information and defines its concepts and overall structure." name="description"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="Microsoft Word 15 (filtered)" name="Generator"/>
<title>STIX Version 2.1</title>
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:"Tms Rmn";
	panose-1:2 2 6 3 4 5 5 2 3 4;}
@font-face
	{font-family:Helv;
	panose-1:2 11 6 4 2 2 2 3 2 4;}
@font-face
	{font-family:"New York";
	panose-1:2 4 5 3 6 5 6 2 3 4;}
@font-face
	{font-family:System;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:Dotum;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimHei;
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:MingLiU;
	panose-1:2 2 5 9 0 0 0 0 0 0;}
@font-face
	{font-family:Mincho;
	panose-1:2 2 6 9 4 3 5 8 3 5;}
@font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:Century;
	panose-1:2 4 6 4 5 5 5 2 3 4;}
@font-face
	{font-family:"Angsana New";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"Cordia New";
	panose-1:2 11 3 4 2 2 2 2 2 4;}
@font-face
	{font-family:Mangal;
	panose-1:2 4 5 3 5 2 3 3 2 2;}
@font-face
	{font-family:Latha;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Sylfaen;
	panose-1:1 10 5 2 5 3 6 3 3 3;}
@font-face
	{font-family:Vrinda;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Raavi;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Shruti;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Sendnya;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Gautami;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Tunga;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Estrangelo Edessa";
	panose-1:3 8 6 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Yu Gothic";
	panose-1:2 11 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:DengXian;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Palatino Linotype";
	panose-1:2 4 5 2 5 5 5 3 3 4;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Segoe UI Emoji";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
@font-face
	{font-family:"Liberation Sans";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	line-height:115%;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
h1
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	page-break-after:avoid;
	font-size:18.0pt;
	font-family:"Arial",sans-serif;
	color:#446CAA;}
h2
	{margin-top:.25in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Arial",sans-serif;
	color:#446CAA;}
h3
	{margin-top:16.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	line-height:115%;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Arial",sans-serif;
	color:#446CAA;}
h4
	{margin-top:14.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	line-height:115%;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Arial",sans-serif;
	color:#446CAA;}
h5
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	color:#446CAA;}
h6
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	line-height:115%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;
	color:#666666;
	font-weight:normal;
	font-style:italic;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	line-height:115%;
	page-break-after:avoid;
	font-size:18.0pt;
	font-family:"Arial",sans-serif;
	color:#446CAA;
	font-weight:bold;}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Arial",sans-serif;
	color:#446CAA;
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;}
span.msoIns
	{mso-style-name:"";
	text-decoration:underline;
	color:red;}
span.msoDel
	{mso-style-name:"";
	text-decoration:line-through;
	color:green;}
.MsoChpDefault
	{font-size:10.0pt;
	font-family:"Arial",sans-serif;}
.MsoPapDefault
	{line-height:115%;}
 /* Page Definitions */
 @page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
</head>
<body>
<h1><a name="_e8slinrhxcc9"></a><span lang="EN">9 STIX Patterning</span></h1>
<h2><a name="_r80k3nm8z2we"></a><span lang="EN">9.1 Definitions</span></h2>
<p class="MsoNormal"><span lang="EN">The terms defined below are used throughout
this document.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<table border="1" cellpadding="0" cellspacing="0" class="affffff6" style="border-collapse:collapse;border:none" width="619">
<tr>
<td style="width:132.0pt;border:solid black 1.0pt;
  background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="176">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Terms</span></b></p>
</td>
<td style="width:203.25pt;border:solid black 1.0pt;
  border-left:none;background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="271">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Definitions</span></b></p>
</td>
<td style="width:129.0pt;border:solid black 1.0pt;
  border-left:none;background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="172">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Example</span></b></p>
</td>
</tr>
<tr>
<td style="width:132.0pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN">whitespace</span></p>
</td>
<td style="width:203.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="271">
<p class="MsoNormal"><span lang="EN">Any Unicode code point that has WSpace set
  as a property, for example, line feeds, carriage returns, tabs, and spaces.</span></p>
</td>
<td style="width:129.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="172">
<p class="MsoNormal"><span lang="EN">n/a</span></p>
</td>
</tr>
<tr>
<td style="width:132.0pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN">Observation</span></p>
</td>
<td style="width:203.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="271">
<p class="MsoNormal"><span lang="EN">Observations represent data about systems or
  networks that is observed at a particular point in time - for example,
  information about a file that existed, a process that was observed running,
  or network traffic that was transmitted between two IPs. In STIX,
  Observations are represented by Observed Data SDOs, with </span><b><span lang="EN" style="font-family:Consolas">number_observed</span></b><span lang="EN">
  observations occurring between their </span><b><span lang="EN" style="font-family:Consolas">first_observed</span></b><span lang="EN"> and </span><b><span lang="EN" style="font-family:Consolas">last_observed</span></b><span lang="EN">
  timestamps. It is not defined when the observations occur within that time
  window.<br/>
<br/>
  For additional background, refer to the STIX Observed Data object definition
  in section <a href="#_p49j1fwoxldc"><span style="color:#1155CC">4.14</span></a>.</span></p>
</td>
<td style="width:129.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="172">
<p class="MsoNormal"><span lang="EN">n/a</span></p>
</td>
</tr>
<tr>
<td style="width:132.0pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN">Comparison Expression</span></p>
</td>
<td style="width:203.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="271">
<p class="MsoNormal"><span lang="EN">Comparison Expressions are the basic
  components of Observation Expressions. They consist of an Object Path and a
  constant joined by a Comparison Operator (listed in section <a href="#_t11hn314cr7w"><span style="color:#1155CC">9.6.1</span></a>,
  Comparison Operators). </span></p>
</td>
<td style="width:129.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="172">
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">user-account:value =
  'Peter'</span></p>
</td>
</tr>
<tr>
<td style="width:132.0pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN">Comparison Operators</span></p>
</td>
<td style="width:203.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="271">
<p class="MsoNormal"><span lang="EN">Comparison Operators are used within
  Comparison Expressions to compare an Object Path against a constant or set of
  constants. </span></p>
</td>
<td style="width:129.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="172">
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">MATCHES</span></p>
</td>
</tr>
<tr>
<td style="width:132.0pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN">Object Path</span></p>
</td>
<td style="width:203.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="271">
<p class="MsoNormal"><span lang="EN">Object Paths define which properties of STIX
  Cyber-observable Objects (SCO) should be evaluated as part of a Comparison
  Expression. SCOs and their properties are defined in section <a href="#_mlbmudhl16lr"><span style="color:#1155CC">6</span></a>.</span></p>
</td>
<td style="width:129.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="172">
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">ipv6-addr:value</span></p>
</td>
</tr>
<tr>
<td style="width:132.0pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN">Observation Expression</span></p>
</td>
<td style="width:203.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="271">
<p class="MsoNormal"><span lang="EN">Observation Expressions consist of one or
  more Comparison Expressions joined with Boolean Operators and surrounded by
  square brackets.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">An Observation Expression may consist of two
  Observation Expressions joined by an Observation Operator. This may be applied
  recursively to compose multiple Observation Expressions into a single
  Observation Expression.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">Observation Expressions may optionally be
  followed by one or more Qualifiers further constraining the result set.
  Qualifiers may be applied to all of the Observation Expressions joined with
  Observation Operators; in this case, parentheses should be used to group the
  set of Observation Expressions, with the Qualifier following the closing
  parenthesis.</span></p>
</td>
<td style="width:129.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="172">
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">[ipv4-addr:value =
  '203.0.113.1' OR ipv4-addr:value = '203.0.113.2']</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">or (with Observation Operator):</span></p>
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;background:#CFE2F3"> </span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">([ipv4-addr:value =
  '198.51.100.5'] FOLLOWEDBY [ipv4-addr:value = '198.51.100.10'])</span><span lang="EN" style="font-size:9.0pt;line-height:115%;font-family:Consolas;
  color:black;background:#CFE2F3"> </span></p>
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;background:#CFE2F3"> </span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">or (with Observation Operator and
  Qualifier):</span></p>
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;background:#CFE2F3"> </span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">([ipv4-addr:value =
  '198.51.100.5' ] AND [ipv4-addr:value = '198.51.100.10']) WITHIN 300 SECONDS</span></p>
</td>
</tr>
<tr>
<td style="width:132.0pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN">Boolean Operators</span></p>
</td>
<td style="width:203.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="271">
<p class="MsoNormal"><span lang="EN" style="color:#222222">Boolean Operators are
  used to combine Comparison Expressions within an Observation Expression.</span></p>
</td>
<td style="width:129.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="172">
<p class="MsoNormal"><span lang="EN">(Comparison Expressions)</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">user-account:value =
  'Peter' OR user-account:value = 'Mary'</span></p>
</td>
</tr>
<tr>
<td style="width:132.0pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN">Qualifier</span></p>
</td>
<td style="width:203.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="271">
<p class="MsoNormal"><span lang="EN">Qualifiers provide a restriction on the
  Observations that are considered valid for matching the preceding Observation
  Expression.</span></p>
</td>
<td style="width:129.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="172">
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">[file:name = 'foo.dll']
  START t'2016-06-01T00:00:00Z' STOP t'2016-07-01T00:00:00Z'</span></p>
</td>
</tr>
<tr>
<td style="width:132.0pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN">Observation Operators</span></p>
</td>
<td style="width:203.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="271">
<p class="MsoNormal"><span lang="EN">Observation Operators are used to combine
  two Observation Expressions operating on two different Observed Data
  instances into a single pattern. </span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">Note that some Observation Operators have
  the same name as Boolean Operators. However, the former connects Comparison
  Expressions and the latter connects Observation Expressions, and therefore
  each has slightly different semantics.</span></p>
</td>
<td style="width:129.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="172">
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">[ipv4-addr:value =
  '198.51.100.5'] AND [ ipv4-addr:value = '198.51.100.10']</span></p>
</td>
</tr>
<tr>
<td style="width:132.0pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN">Pattern Expression</span></p>
</td>
<td style="width:203.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="271">
<p class="MsoNormal"><span lang="EN">A Pattern Expression represents a valid
  instance of a STIX cyber observable pattern. The most basic Pattern
  Expression consists of a single Observation Expression containing a single
  Comparison Expression.</span></p>
</td>
<td style="width:129.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="172">
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">[file:size = 25536]</span></p>
</td>
</tr>
</table>
<p class="MsoNormal"><span lang="EN"> </span></p>
<h2><a name="_bvkuhhujn5qm"></a><span lang="EN">9.2 Constants</span></h2>
<p class="MsoNormal"><span lang="EN">The data types enumerated below are supported
as operands within Comparison Expressions. This table is included here as a
handy reference for implementers.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">Note that unlike SCOs (which are defined in
terms of the MTI JSON serialization), STIX Patterns are Unicode strings,
regardless of the underlying serialization, hence the data types defined in the
table below in some cases differ from the definitions contained in section <a href="#_gv21fm9t1qgx"><span style="color:#1155CC">2</span></a>.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">Each constant defined in Patterning has a
limited set of STIX Data types that they are allowed to be compared against. In
some cases, there are multiple STIX Data Types that could be compared against a
STIX Patterning Constant; this is due to the fact that certain STIX Data Types
are semantically indistinguishable because of their JSON serialization. The
STIX Comparable Data Type(s) column in the table below defines these
limitations.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<table border="1" cellpadding="0" cellspacing="0" class="affffff7" style="border-collapse:collapse;border:none" width="606">
<tr>
<td style="width:124.5pt;border:solid black 1.0pt;
  background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="166">
<p class="MsoNormal"><b><span lang="EN" style="color:white">STIX Patterning
  Constant</span></b></p>
</td>
<td style="width:105.75pt;border:solid black 1.0pt;
  border-left:none;background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="141">
<p class="MsoNormal"><b><span lang="EN" style="color:white">STIX Comparable Data
  Type(s)</span></b></p>
</td>
<td style="width:224.25pt;border:solid black 1.0pt;
  border-left:none;background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="299">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Description</span></b></p>
</td>
</tr>
<tr>
<td style="width:124.5pt;border:solid black 1.0pt;
  border-top:none;background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="166">
<p class="MsoNormal"><b><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">boolean</span></b></p>
</td>
<td style="width:105.75pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="141">
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">boolean</span></p>
</td>
<td style="width:224.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="299">
<p class="MsoNormal"><span lang="EN" style="color:black">A constant of </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:#F9F2F4">boolean</span><span lang="EN" style="color:black"> type encodes truth or falsehood. Boolean truth
  is denoted by the literal </span><span lang="EN" style="font-family:Consolas;
  color:#073763;background:#CFE2F3">true</span><span lang="EN" style="color:black">
  and falsehood by the literal </span><span lang="EN" style="font-family:Consolas;
  color:#073763;background:#CFE2F3">false</span><span lang="EN" style="color:
  black">.</span></p>
</td>
</tr>
<tr>
<td style="width:124.5pt;border:solid black 1.0pt;
  border-top:none;background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="166">
<p class="MsoNormal"><b><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">binary</span></b></p>
</td>
<td style="width:105.75pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="141">
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">binary</span></p>
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">hex</span></p>
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">string</span></p>
</td>
<td style="width:224.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="299">
<p class="MsoNormal"><span lang="EN" style="color:black">A constant of </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:#F9F2F4">binary</span><span lang="EN" style="color:black"> type is a base64 encoded array of octets (8-bit
  bytes) per [<a href="#kix.g675gx7pig03"><span style="color:#1155CC">RFC4648</span></a>].
  The base64 string <b>MUST</b> be surrounded by apostrophes (''' U+0027) and
  prefixed by a 'b' (U+0062). Line feeds in the base64 encoded data <b>MUST</b>
  be supported and ignored but are not required to be inserted.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN" style="color:black">Example:</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">b'ABI='</span></p>
</td>
</tr>
<tr>
<td style="width:124.5pt;border:solid black 1.0pt;
  border-top:none;background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="166">
<p class="MsoNormal"><b><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">hex</span></b></p>
</td>
<td style="width:105.75pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="141">
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">binary</span><b><span lang="EN" style="color:black"><br/>
</span></b><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">hex</span></p>
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">string</span></p>
</td>
<td style="width:224.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="299">
<p class="MsoNormal"><span lang="EN" style="color:black">A constant of </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:#F9F2F4">hex</span><span lang="EN" style="color:black"> type encodes an array of octets (8-bit bytes) as
  hexadecimal. The string <b>MUST</b> consist of an even number of hexadecimal
  characters, which are the digits '0' through '9' and the letters 'a' through
  'f'. The hex string <b>MUST</b> be surrounded by apostrophes (''' U+0027) and
  prefixed by an 'h' (U+0068).</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN" style="color:black">Example:</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">h'ffc3'</span></p>
</td>
</tr>
<tr>
<td style="width:124.5pt;border:solid black 1.0pt;
  border-top:none;background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="166">
<p class="MsoNormal"><b><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">integer</span></b></p>
</td>
<td style="width:105.75pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="141">
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">integer</span><b><span lang="EN" style="color:black"><br/>
</span></b><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">float</span></p>
</td>
<td style="width:224.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="299">
<p class="MsoNormal"><span lang="EN" style="color:black">A constant of </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:#F9F2F4">integer</span><span lang="EN" style="color:black"> type encodes a signed decimal number in the
  usual fashion (e.g., 123). In the case of positive integers, the integer <b>MUST</b>
  be represented as-is, omitting the plus sign ('+' U+002b). Negative integers <b>MUST</b>
  be represented by prepending a hyphen-minus ('-' U+002d).</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN" style="color:black">When compared against a </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:#F9F2F4">float</span><span lang="EN" style="color:black">, the full value must be compared and must not be
  truncated. For example, the result of comparing a STIX Patterning constant
  integer value of 1 to a </span><span lang="EN" style="font-family:Consolas;
  color:#C7254E;background:#F9F2F4">float</span><span lang="EN" style="color:
  black"> value of 1.5 is not equal.</span></p>
<p class="MsoNormal"><span lang="EN" style="color:black"> </span></p>
<p class="MsoNormal"><span lang="EN" style="color:black">The valid range of
  values is defined in section <a href="#_gv21fm9t1qgx"><span style="color:
  #1155CC">2</span></a>. </span></p>
</td>
</tr>
<tr>
<td style="width:124.5pt;border:solid black 1.0pt;
  border-top:none;background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="166">
<p class="MsoNormal"><b><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">float</span></b></p>
</td>
<td style="width:105.75pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="141">
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">integer</span></p>
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">float</span></p>
</td>
<td style="width:224.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="299">
<p class="MsoNormal"><span lang="EN" style="color:black">A constant of </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:#F9F2F4">float</span><span lang="EN" style="color:black"> type encodes a floating-point number in the
  usual fashion (e.g., 123.456). In the case of positive floating-point number,
  the floating-point number <b>MUST</b> be represented as-is, omitting the plus
  sign' ('+' U+002b). Negative floating point-numbers <b>MUST</b> be
  represented by prepending a hyphen-minus ('-' U+002d).</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN" style="color:black">The valid range of
  values is defined in <a href="#_gv21fm9t1qgx"><span style="color:#1155CC">2</span></a>.</span></p>
</td>
</tr>
<tr>
<td style="width:124.5pt;border:solid black 1.0pt;
  border-top:none;background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="166">
<p class="MsoNormal"><b><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">string</span></b></p>
</td>
<td style="width:105.75pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="141">
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">string</span></p>
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">binary</span><b><span lang="EN" style="color:black"><br/>
</span></b><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">hex</span></p>
</td>
<td style="width:224.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="299">
<p class="MsoNormal"><span lang="EN" style="color:black">A constant of </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:#F9F2F4">string</span><span lang="EN" style="color:black"> type encodes a string as a list of Unicode code
  points surrounded by apostrophes (''' U+0027).</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN" style="color:black">The escape character is
  the backslash ('\' U+005c). Only the apostrophe or the backslash may follow,
  and in that case, the respective character is used for the sequence.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN" style="color:black">If a string only
  contains codepoints less than (U+0100), then the string <b>MAY</b> be
  converted to a binary type value (if needed for comparison). The mapping is
  code point U+0000 to 00 through U+00ff to ff.</span></p>
</td>
</tr>
<tr>
<td style="width:124.5pt;border:solid black 1.0pt;
  border-top:none;background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="166">
<p class="MsoNormal"><b><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">timestamp</span></b></p>
</td>
<td style="width:105.75pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="141">
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">timestamp</span></p>
</td>
<td style="width:224.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  background:white;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="299">
<p class="MsoNormal"><span lang="EN" style="color:black">A constant of </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:#F9F2F4">timestamp</span><span lang="EN" style="color:black"> type encodes a STIX timestamp (as specified in
  section <a href="#_ksbm2nost85y"><span style="color:#1155CC">2.16</span></a>
  as a string. The timestamp string <b>MUST</b> be surrounded by apostrophes
  (''' U+0027) and prefixed with a 't' (U+0074).</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN" style="color:black">Example:</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">t'2014-01-13T07:03:17Z'</span></p>
</td>
</tr>
</table>
<p class="MsoNormal"><span lang="EN"> </span></p>
<h2><a name="_me3pzm77qfnf"></a><span lang="EN">9.3 STIX Patterns</span></h2>
<p class="MsoNormal"><span lang="EN">STIX Patterns are composed of multiple
building blocks, ranging from simple key-value comparisons to more complex,
context-sensitive expressions. The most fundamental building block is the
Comparison Expression, which is a comparison between a single property of a SCO
and a given constant using a Comparison Operator. As a simple example, one
might use the following Comparison Expression (contained within an Observation
Expression) to match against an IPv4 address:</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:11.0pt;line-height:115%"> </span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[ipv4-addr:value =
'198.51.100.1/32']</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:11.0pt;line-height:115%"> </span></p>
<p class="MsoNormal"><span lang="EN">Moving up a level of complexity, the next
building block of a STIX Pattern is the Observation Expression, which consists
of one or more Comparison Expressions joined by Boolean Operators and bounded
by square brackets. An Observation Expression refines which set of cyber
observable data (i.e., as part of an Observation) will match the pattern, by
selecting the set that has the SCOs specified by the Comparison Expressions. An
Observation Expression consisting of a single Comparison Expression is the most
basic valid STIX Pattern. Building upon the previous example, one might
construct an Observation Expression to match against multiple IPv4 addresses
and an IPv6 address:</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:11.0pt;line-height:115%"> </span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[ipv4-addr:value =
'198.51.100.1/32' OR ipv4-addr:value = '203.0.113.33/32' OR ipv6-addr:value =
'2001:0db8:dead:beef:dead:beef:dead:0001/128']</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:11.0pt;line-height:115%"> </span></p>
<p class="MsoNormal"><span lang="EN">Observation Expressions may be followed by one
or more Qualifiers, which allow for the expression of further restrictions on
the set of data matching the pattern. Continuing with the above example, one
might use a Qualifier to state that the IP addresses must be observed several
times in repetition:</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:11.0pt;line-height:115%"> </span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[ipv4-addr:value =
'198.51.100.1/32' OR ipv4-addr:value = '203.0.113.33/32' OR ipv6-addr:value =
'2001:0db8:dead:beef:dead:beef:dead:0001/128'] REPEATS 5 TIMES</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:11.0pt;line-height:115%"> </span></p>
<p class="MsoNormal"><span lang="EN">The final, highest level building block of
STIX Patterning combines two or more Object Expressions via Observation
Operators, yielding a STIX Pattern capable of matching across multiple STIX
Observed Data SDOs. Building further upon our previous example, one might use
an Observation Operator to specify that an observation of a particular domain
name must follow the observation of the IP addresses (note the use of
parentheses to encapsulate the two Observation Expressions), along with a
different Qualifier to state that both the IP address and domain name must be
observed within a specific time window:</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:11.0pt;line-height:115%"> </span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">([ipv4-addr:value =
'198.51.100.1/32' OR ipv4-addr:value = '203.0.113.33/32' OR ipv6-addr:value =
'2001:0db8:dead:beef:dead:beef:dead:0001/128'] FOLLOWEDBY [domain-name:value =
'example.com']) WITHIN 600 SECONDS</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;background:#CFE2F3"> </span></p>
<p class="MsoNormal"><span lang="EN">The diagram below depicts a truncated version
of the various STIX Patterning components in the above example.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN"><img border="0" height="164" id="image3.png" src="stix-v2.1-os_files/image003.jpg" width="625"/></span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<h2><a name="_oxfmsowx7p3y"></a><span lang="EN">9.4 Pattern Expressions</span></h2>
<p class="MsoNormal"><span lang="EN">Pattern Expressions evaluate to true or false.
They comprise one or more Observation Expressions joined by Observation
Operators. Pattern Expressions are evaluated against a set of specific
Observations. If one or more of those Observations match the Pattern
Expression, then it evaluates to true. If no Observations match, the Pattern
Expression evaluates to false.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">Pattern Expressions <b>MUST</b> be encoded as
Unicode strings.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">Whitespace (i.e., Unicode code points where <span style="color:#252525;background:white">WSpace=Y)</span> in the pattern string
is used to delimit parts of the pattern, including keywords, constants, and
field objects. Whitespace characters between operators, including line feeds
and carriage returns, <b>MUST </b>be allowed. Multiple whitespace characters in
a row <b>MUST</b> be treated as a single whitespace character.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">An invalid pattern resulting from parsing
error or invalid constants (e.g., an invalid hex or binary constant) <b>MUST</b>
<b>NOT</b> match any Observations. </span></p>
<h2><a name="_x1nsjyy75wtq"></a><span lang="EN">9.5 Observation Expressions</span></h2>
<p class="MsoNormal"><span lang="EN">Observation Expressions comprise one or more
Comparison Expressions, joined via Boolean Operators.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">Observation Expressions <b>MUST</b> be
delimited by left square bracket ('[' U+005b) and right square bracket (']'
U+005d). One or more Observation Expression Qualifiers <b>MAY</b> be provided
after the closing square bracket or closing parenthesis of an Observation
Expression. Observation Expressions <b>MAY</b> be joined by Observation
Operators.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">Individual Observation Expressions (e.g., </span><span lang="EN" style="font-size:9.0pt;line-height:115%;font-family:Consolas;
color:black;background:#EFEFEF">[a = b]</span><span lang="EN">) match against a
single Observation, i.e., a single STIX Observed Data instance. In cases where
matching against <i>multiple</i> Observations is required, two or more
Observation Expressions may be combined via Observation Operators, indicating
that the pattern <b>MUST</b> be evaluated against two or more distinct
Observations; however, in the case of </span><span lang="EN" style="font-family:
Consolas;color:#073763;background:#CFE2F3">OR</span><span lang="EN">, if the
first Observation Expression evaluates to </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">true</span><span lang="EN">, then evaluation <b>MUST</b> terminate and return </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">true</span><span lang="EN">.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">When matching an Observation against an
Observation Expression, all Comparison Expressions contained within the
Observation Expression <b>MUST</b> start matching against the same SCO in the
Observation. That is, when resolving object paths of each Comparison
Expression, the &lt;object-type&gt;:&lt;property_name&gt; <b>MUST</b> start
from the same SCO.  Different SCO's may ultimately be used in matching, but
they <b>MUST</b> be referenced from the same, single SCO. </span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">For example, the following observed data does
not match this example observation clause because although these IP addresses
are both part of the same observed-data object, there is not a single
network-traffic SCO that references each IP address, and therefore does not
satisfy the condition in the preceding paragraph:</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[
network-traffic:src_ref.value = '203.0.113.10' AND
network-traffic:dst_ref.value = '198.51.100.58' ] </span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">{</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">  "type":
"observed-data",</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">  "id":
"observed-data--0960319a-3cab-4258-a143-4dbb25525bb1",</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF"> 
"first_observed": "2019-10-20T00:12:01.000000Z",</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF"> 
"last_observed": "2019-10-20T00:51:02.000000Z",</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF"> 
"number_observed": 1,</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">  "objects": {</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">    "0": {</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">        "type":
"network-traffic",</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">       
"src_ref": "1"</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">    },</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">    "1": {</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">        "type":
"ipv4-addr",</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">        "value":
"203.0.113.10"</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">    },</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">    "2": {</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">        "type":
"network-traffic",</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">       
"dst_ref": "3"</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">    },</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">    "3": {</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">        "type":
"ipv4-addr",</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">        "value":
"198.51.100.58"</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">    }</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">  }</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">}</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">An Observation Expression <b>MAY </b>contain
Comparison Expressions with Object Paths that start with different object
types, but such Comparison Expressions <b>MUST </b>be joined by OR. All operands
of AND in an Observation Expression <b>MUST</b> be satisfiable with the same
object.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">For example, consider the following Pattern
Expression:</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[(type-a:property-j = 'W'
AND type-a:property-k = 'X') OR (type-b:property-m = 'Y' AND type-b:property-n
= 'Z')]</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">This expression can match an Observable with
an object of either </span><span lang="EN" style="font-size:9.0pt;line-height:
115%;font-family:Consolas;color:black;background:#EFEFEF">type-a</span><span lang="EN"> or </span><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">type-b</span><span lang="EN">, but both Comparison Expressions for that specific type must evaluate
to true for the same object. Comparison Expressions that are intended to match
a single object type can be joined by either AND or OR. For example:</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[type-a:property-j = 'W'
AND type-a:property-k = 'X' OR type-a:property-l = 'Z']</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">As AND has higher precedence than OR, the
preceding example requires an Observation to have either both </span><span lang="EN" style="font-size:9.0pt;line-height:115%;font-family:Consolas;
color:black;background:#EFEFEF">property-j = 'W' AND property-k = 'X'</span><span lang="EN"> or just </span><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">property-l = 'Z'</span><span lang="EN">.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">Observation Expressions, along with their
Observation Operators and optional Qualifiers, <b>MAY</b> be surrounded with
parentheses to delineate which Observation Expressions the Qualifiers apply to.
For example:</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">([ a ] AND [ b ] REPEATS 5
TIMES) WITHIN 5 MINUTES</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">The preceding example results in one <i>a</i>
and 5 <i>bs</i> that all match in a 5-minute period. As another example:</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">([ a ] AND [ b ]) REPEATS
5 TIMES WITHIN 5 MINUTES</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">The preceding example results in 5 <i>a</i>s
and 5 <i>bs</i> (10 Observations) that all match in a 5-minute period.</span></p>
<h3><a name="_itrc2pdxk4ef"></a><span lang="EN">9.5.1 Observation Expression
Qualifiers</span></h3>
<p class="MsoNormal"><span lang="EN">Each Observation Expression <b>MAY</b> have
additional temporal or repetition restrictions using the respective </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">WITHIN</span><span lang="EN">, </span><span lang="EN" style="font-family:Consolas;color:#073763;
background:#CFE2F3">START</span><span lang="EN">/</span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">STOP</span><span lang="EN">, and </span><span lang="EN" style="font-family:Consolas;color:#073763;
background:#CFE2F3">REPEATS</span><span lang="EN"> keywords. An Observation
Expression <b>MUST NOT</b> have more than one Qualifier of a particular type.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<table border="1" cellpadding="0" cellspacing="0" class="affffff8" style="margin-left:-.25pt;border-collapse:collapse;border:none" width="639">
<tr>
<td style="width:119.25pt;border:solid black 1.0pt;
  background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="159">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Qualifiers</span></b></p>
</td>
<td style="width:5.0in;border:solid black 1.0pt;
  border-left:none;background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="480">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Description</span></b></p>
</td>
</tr>
<tr>
<td style="width:119.25pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="159">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">REPEATS</span><span lang="EN"> <i>x</i> </span><span lang="EN" style="font-family:Consolas;
  color:#073763;background:#CFE2F3">TIMES</span></p>
</td>
<td style="width:5.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="480">
<p class="MsoNormal"><i><span lang="EN">a </span></i><b><span lang="EN">MUST</span></b><span lang="EN"> be an Observation Expression or a preceding Qualifier. <i>a</i> <b>MUST
  </b>match at least <i>x</i> times, where each match is a different
  Observation. <i>x </i><b>MUST</b> be a positive integer.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">This is purely a shorthand way of writing:</span></p>
<p class="MsoNormal"><span lang="EN"> "<i>a" </i>followed by "AND <i>a",
  </i>x-1 times.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">Example:</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">[ b ] FOLLOWEDBY [ c ]
  REPEATS 5 TIMES</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">In this example, the </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">REPEATS</span><span lang="EN"> applies to <i>c</i>, and it does not apply to <i>b</i>. The results
  will be <i>b</i> plus 5 <i>c</i>'s where all 5 <i>c</i>'s were observed after
  the <i>b</i>. Note that there is only a single Qualifier in this example;
  more complex patterns may use more than one.</span></p>
</td>
</tr>
<tr>
<td style="width:119.25pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="159">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">WITHIN</span><span lang="EN"> <i>x</i> </span><span lang="EN" style="font-family:Consolas;
  color:#073763;background:#CFE2F3">SECONDS</span><span lang="EN"> </span></p>
</td>
<td style="width:5.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="480">
<p class="MsoNormal"><i><span lang="EN">a </span></i><b><span lang="EN">MUST</span></b><span lang="EN"> be an Observation Expression or a preceding Qualifier. All
  Observations matched by <i>a</i> <b>MUST </b>occur, or have been observed,
  within the specified time window. <i>x </i><b>MUST</b> be a positive
  floating-point or integer value.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">If there is a set of two or more
  Observations matched by <i>a</i>, the most recent Observation timestamp
  contained within that set <b>MUST NOT</b> be equal to or later than the delta
  of the earliest Observation timestamp within the set plus the specified time
  window. </span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">Example:</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">([file:hashes.'SHA-256'
  = '13987239847...'] AND [win-registry-key:key = 'hkey']) WITHIN 120 SECONDS</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">The above Pattern Expression looks for a
  file hash and a registry key that were observed within 120 seconds of each
  other. The parentheses are needed to apply the </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">WITHIN</span><span lang="EN"> Qualifier to both Observation Expressions.</span></p>
</td>
</tr>
<tr>
<td style="width:119.25pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="159">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">START</span><span lang="EN"> <i>x</i> </span><span lang="EN" style="font-family:Consolas;
  color:#073763;background:#CFE2F3">STOP</span><span lang="EN"> <i>y</i></span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
</td>
<td style="width:5.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="480">
<p class="MsoNormal"><i><span lang="EN">a </span></i><b><span lang="EN">MUST</span></b><span lang="EN"> be an Observation Expression or a preceding Qualifier. All
  Observations that match <i>a</i> <b>MUST</b> have an observation time &gt;= <i>x</i>
  and &lt; <i>y</i>.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><i><span lang="EN">x</span></i><span lang="EN"> and <i>y</i> <b>MUST</b>
  be of type </span><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">timestamp</span><span lang="EN">.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">In the event that the Pattern Expression is
  being used inside a STIX Indicator </span><span lang="EN" style="font-family:
  Consolas;color:#C7254E;background:#F9F2F4">pattern</span><span lang="EN">
  property (see section <a href="#_muftrcpnf89v"><span style="color:#1155CC">4.7</span></a>)
  <i>x</i> <b>SHOULD</b> be greater than or equal to the value contained in the
  </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:
  #F9F2F4">valid_from</span><span lang="EN"> Indicator property, and <i>y</i> <b>SHOULD</b>
  be less than or equal to the value contained in the </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:#F9F2F4">valid_until</span><span lang="EN"> Indicator property.</span></p>
</td>
</tr>
</table>
<p class="MsoNormal"><span lang="EN"> </span></p>
<h3><a name="_l72a2uz085od"></a><span lang="EN">9.5.2 Observation Operators</span></h3>
<p class="MsoNormal"><span lang="EN">Two or more Observation Expressions <b>MAY</b>
be combined using an Observation Operator in order to further constrain the set
of Observations that match against the Pattern Expression.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<table border="1" cellpadding="0" cellspacing="0" class="affffff9" style="border-collapse:collapse;border:none" width="632">
<tr>
<td style="width:136.5pt;border:solid black 1.0pt;
  background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="182">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Observation Operators</span></b></p>
</td>
<td style="width:208.5pt;border:solid black 1.0pt;
  border-left:none;background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="278">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Description</span></b></p>
</td>
<td style="width:129.0pt;border:solid black 1.0pt;
  border-left:none;background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="172">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Associativity</span></b></p>
</td>
</tr>
<tr>
<td style="width:136.5pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="182">
<p class="MsoNormal"><span lang="EN">[<i> a</i> ] </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">AND</span><span lang="EN"> [ <i>b </i>]</span></p>
</td>
<td style="width:208.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="278">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> and <i>b</i> <b>MUST
  </b>both<b> </b>be Observation Expressions and <b>MUST</b> both evaluate to
  true on <i>different</i> Observations.</span></p>
</td>
<td style="width:129.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="172">
<p class="MsoNormal"><span lang="EN">Left to right</span></p>
</td>
</tr>
<tr>
<td style="width:136.5pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="182">
<p class="MsoNormal"><span lang="EN">[<i> a</i> ] </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">OR</span><span lang="EN"> [ <i>b </i>]</span></p>
</td>
<td style="width:208.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="278">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> and <i>b</i> <b>MUST
  </b>both<b> </b>be Observation Expressions and one of <i>a</i> or <i>b</i> <b>MUST</b>
  evaluate to true on <i>different</i> Observations.</span></p>
</td>
<td style="width:129.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="172">
<p class="MsoNormal"><span lang="EN">Left to right</span></p>
</td>
</tr>
<tr>
<td style="width:136.5pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="182">
<p class="MsoNormal"><span lang="EN">[<i> a</i> ] </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">FOLLOWEDBY</span><span lang="EN"> [ <i>b </i>]</span></p>
</td>
<td style="width:208.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="278">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> and <i>b</i> <b>MUST</b>
  both be Observation Expressions. Both<b> </b><i>a</i> and <i>b</i> <b>MUST</b>
  both evaluate to true, where the<i> </i>observation timestamp associated with
  <i>b<b> </b></i>is greater than or equal to the observation timestamp
  associated with <i>a</i> and <b>MUST</b> evaluate to true on <i>different</i>
  Observations.</span></p>
</td>
<td style="width:129.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="172">
<p class="MsoNormal"><span lang="EN">Left to right</span></p>
</td>
</tr>
</table>
<p class="MsoNormal"><span lang="EN" style="font-size:11.0pt;line-height:115%"> </span></p>
<p class="MsoNormal"><span lang="EN">For example, consider the following Pattern
Expression:</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[ a = 'b' ] FOLLOWEDBY [ c
= 'd' ] REPEATS 5 TIMES</span></p>
<p class="MsoNormal"><span lang="EN">The preceding expression says to match an
Observation with <i>a</i> equal to 'b' that precedes 5 occurrences of
Observations that have <i>c</i> equal to d, for a total of 6 Observations
matched. This interpretation is due to qualifiers not being greedy and is
equivalent to </span><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[ a = 'b' ] FOLLOWEDBY ( [
c = 'd' ] REPEATS 5 TIMES)</span><span lang="EN">.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">Alternatively, using parentheses to group the
initial portion, we get the following example:</span></p>
<p class="MsoNormal"><span lang="EN"> </span><span lang="EN" style="font-size:9.0pt;
line-height:115%;font-family:Consolas;color:black;background:#EFEFEF">([ a =
'b' ] FOLLOWEDBY [ c = 'd' ]) REPEATS 5 TIMES</span></p>
<p class="MsoNormal"><span lang="EN">The preceding expression</span><span lang="EN" style="font-size:9.0pt;line-height:115%"> </span><span lang="EN">will match 5
pairs of Observations where <i>a</i> equals 'b' followed by an Observation
where <i>c</i> is equal to 'd', for a total of 10 Observations matched.</span></p>
<h3><a name="_ictqjpsw7dia"></a><span lang="EN">9.5.3 Operator Precedence</span></h3>
<p class="MsoNormal"><span lang="EN">Operator associativity and precedence may be
overridden by the use of parentheses. Unless otherwise specified, operator
associativity (including for parentheses) is left-to-right. Precedence in the
below table is from highest to lowest.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<table border="1" cellpadding="0" cellspacing="0" class="affffffa" style="border-collapse:collapse;border:none" width="623">
<tr>
<td style="width:171.0pt;border:solid black 1.0pt;
  background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="228">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Operators</span></b></p>
</td>
<td style="width:72.75pt;border:solid black 1.0pt;
  border-left:none;background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="97">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Associativity</span></b></p>
</td>
<td style="width:223.5pt;border:solid black 1.0pt;
  border-left:none;background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="298">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Valid Scope</span></b></p>
</td>
</tr>
<tr>
<td style="width:171.0pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="228">
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#073763;
  background:#CFE2F3">()</span></p>
</td>
<td style="width:72.75pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="97">
<p class="MsoNormal"><span lang="EN">left to right</span></p>
</td>
<td style="width:223.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="298">
<p class="MsoNormal"><span lang="EN">Observation Expression or Pattern
  Expression, Observation Expression and Qualifier</span></p>
</td>
</tr>
<tr>
<td style="width:171.0pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="228">
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#073763;
  background:#CFE2F3">AND</span></p>
</td>
<td style="width:72.75pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="97">
<p class="MsoNormal"><span lang="EN">left to right</span></p>
</td>
<td style="width:223.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="298">
<p class="MsoNormal"><span lang="EN">Observation Expression, Pattern Expression</span></p>
</td>
</tr>
<tr>
<td style="width:171.0pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="228">
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#073763;
  background:#CFE2F3">OR</span></p>
</td>
<td style="width:72.75pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="97">
<p class="MsoNormal"><span lang="EN">left to right</span></p>
</td>
<td style="width:223.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="298">
<p class="MsoNormal"><span lang="EN">Observation Expression, Pattern Expression</span></p>
</td>
</tr>
<tr>
<td style="width:171.0pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="228">
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#073763;
  background:#CFE2F3">FOLLOWEDBY</span><span lang="EN"> (Observation Operator)</span></p>
</td>
<td style="width:72.75pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="97">
<p class="MsoNormal"><span lang="EN">left to right</span></p>
</td>
<td style="width:223.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="298">
<p class="MsoNormal"><span lang="EN">Pattern Expression</span></p>
</td>
</tr>
</table>
<p class="MsoNormal"><span lang="EN"> </span></p>
<h2><a name="_boiciucr9smf"></a><span lang="EN">9.6 Comparison Expressions</span></h2>
<p class="MsoNormal"><span lang="EN">Comparison Expressions are the most basic
components of STIX Patterning, comprising an Object Path and a constant joined
by a Comparison Operator. Each Comparison Expression is a singleton, and so
they are evaluated from left to right.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">A Boolean Operator joins two Comparison
Expressions together. In the following table, <i>a</i> or <i>b</i> is either a
Comparison Expression or a composite expression (which may be composed
recursively) consisting of two or more Comparison Expressions joined with
Boolean Operators and enclosed by parentheses.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<table border="1" cellpadding="0" cellspacing="0" class="affffffb" style="margin-left:-.75pt;border-collapse:collapse;border:none" width="622">
<tr>
<td style="width:96.75pt;border:solid black 1.0pt;
  background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="129">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Boolean Operator</span></b></p>
</td>
<td style="width:284.25pt;border:solid black 1.0pt;
  border-left:none;background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="379">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Description</span></b></p>
</td>
<td style="width:85.5pt;border:solid black 1.0pt;
  border-left:none;background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="114">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Associativity</span></b></p>
</td>
</tr>
<tr>
<td style="width:96.75pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt" valign="top" width="129">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">AND</span><span lang="EN"> <i>b</i></span></p>
</td>
<td style="width:284.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="379">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> and <i>b</i> <b>MUST</b>
  both be Comparison Expressions or a composite expression (which may be
  composed recursively) consisting of two or more Comparison Expressions joined
  with Boolean Operators and enclosed by parentheses. </span></p>
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> and <i>b</i> <b>MUST</b>
  both evaluate to true on the same Observation.</span></p>
</td>
<td style="width:85.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="114">
<p class="MsoNormal"><span lang="EN">Left to right</span></p>
</td>
</tr>
<tr>
<td style="width:96.75pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt" valign="top" width="129">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">OR</span><span lang="EN"> <i>b</i></span></p>
</td>
<td style="width:284.25pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="379">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> and <i>b</i> <b>MUST</b>
  both be Comparison Expressions or a composite expression (which may be
  composed recursively) consisting of two or more Comparison Expressions joined
  with Boolean Operators and enclosed by parentheses. </span></p>
<p class="MsoNormal"><span lang="EN">Either <i>a</i> or <i>b</i> <b>MUST</b>
  evaluate to true.</span></p>
</td>
<td style="width:85.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="114">
<p class="MsoNormal" style="margin-right:-1.25in"><span lang="EN">Left to right</span></p>
</td>
</tr>
</table>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">Comparison Expressions may include one or more
Object Path(s) not obtainable within a given Observation, either because the
Object Path(s) are not present within the Observation or because the evaluating
entity does not have access to the data necessary in order to evaluate the
specified Object Path(s). When evaluating a Comparison Expression against one
or more Object Path(s) that are not present or whose data cannot be obtained,
the Comparison Expression <b>MUST</b> evaluate to <b>FALSE</b>, regardless of
the operators included in the expression.</span></p>
<h3><a name="_t11hn314cr7w"></a><span lang="EN">9.6.1 Comparison Operators</span></h3>
<p class="MsoNormal"><span lang="EN">The table below describes the available
Comparison Operators for use in Comparison Expressions; in the table, <i>a</i> <b>MUST</b>
be an Object Path and <i>b </i><b>MUST</b> be a constant. If the arguments to
the Comparison Operators are of incompatible types (e.g., the Object Path is an
integer and the constant is a string), the results are false; the sole
exception is the </span><span lang="EN" style="font-family:Consolas;color:#073763;
background:#CFE2F3">!=</span><span lang="EN"> operator in which case the result
is true. Some STIX Patterning constants and STIX data types may be comparable
in a Comparison Expression. For example, the </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:#F9F2F4">hex</span><span lang="EN"> and </span><span lang="EN" style="font-family:Consolas;color:#C7254E;
background:#F9F2F4">binary</span><span lang="EN"> types both represent binary
data, and their representative binary data is that which must be compared for
equality. See section <a href="#_gv21fm9t1qgx"><span style="color:#1155CC">2</span></a>
for type compatibility between STIX Patterning and STIX types.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">A Comparison Operator <b>MAY </b>be preceded
by the modifier </span><span lang="EN" style="font-family:Consolas;color:#073763;
background:#CFE2F3">NOT</span><span lang="EN">, in which case the resultant
Comparison Expression is logically negated.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<table border="1" cellpadding="0" cellspacing="0" class="affffffc" style="margin-left:-.75pt;border-collapse:collapse;border:none" width="629">
<tr>
<td style="width:98.25pt;border:solid black 1.0pt;
  background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="131">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Comparison Operator</span></b></p>
</td>
<td style="width:241.5pt;border:solid black 1.0pt;
  border-left:none;background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="322">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Description</span></b></p>
</td>
<td style="width:132.0pt;border:solid black 1.0pt;
  border-left:none;background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="176">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Example</span></b></p>
</td>
</tr>
<tr>
<td style="width:98.25pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt" valign="top" width="131">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">=</span><span lang="EN"> <i>b</i></span></p>
</td>
<td style="width:241.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="322">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> and <i>b</i> <b>MUST</b>
  be equal (transitive), where <i>a </i><b>MUST</b> be an Object Path and <i>b </i><b>MUST</b>
  be a constant of the same data type as the object property specified by <i>a</i>.</span></p>
</td>
<td style="width:132.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">file:name = 'foo.dll'</span></p>
</td>
</tr>
<tr>
<td style="width:98.25pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt" valign="top" width="131">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">!=</span><span lang="EN"> <i>b</i></span></p>
</td>
<td style="width:241.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="322">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> and <i>b</i> <b>MUST</b>
<b>NOT</b> be equal (transitive), where <i>a </i><b>MUST</b> be an Object
  Path and <i>b </i><b>MUST</b> be a constant of the same data type as the
  Object property specified by <i>a</i>.</span></p>
</td>
<td style="width:132.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">file:size != 4112</span></p>
</td>
</tr>
<tr>
<td style="width:98.25pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt" valign="top" width="131">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">&gt;</span><span lang="EN"> <i>b</i></span></p>
</td>
<td style="width:241.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="322">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> is numerically
  or lexically greater than <i>b</i>, where <i>a</i> <b>MUST</b> be an Object
  Path and <i>b</i> <b>MUST</b> be a constant of the same data type as the
  Object property specified by <i>a</i>. </span></p>
</td>
<td style="width:132.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">file:size &gt; 256</span></p>
</td>
</tr>
<tr>
<td style="width:98.25pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt" valign="top" width="131">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">&lt;</span><span lang="EN"> <i>b</i></span></p>
</td>
<td style="width:241.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="322">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> is numerically
  or lexically less than <i>b</i>, where <i>a</i> <b>MUST</b> be an Object Path
  and<i> b</i> <b>MUST</b> be a constant of the same data type as the Object
  property specified by <i>a</i>.</span></p>
</td>
<td style="width:132.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">file:size &lt; 1024</span></p>
</td>
</tr>
<tr>
<td style="width:98.25pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt" valign="top" width="131">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">&lt;=</span><span lang="EN"> <i>b</i></span></p>
</td>
<td style="width:241.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="322">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> is numerically
  or lexically less than or equal to <i>b</i>, where <i>a</i> <b>MUST</b> be an
  Object Path and <i>b</i> <b>MUST</b> be a constant of the same data type as
  the Object property specified by <i>a</i>.</span></p>
</td>
<td style="width:132.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">file:size &lt;= 25145</span></p>
</td>
</tr>
<tr>
<td style="width:98.25pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt" valign="top" width="131">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">&gt;=</span><span lang="EN"> <i>b</i></span></p>
</td>
<td style="width:241.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="322">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> is numerically
  or lexically greater than or equal to <i>b</i>, where <i>a </i><b>MUST</b> be
  an Object Path and <i>b</i> <b>MUST</b> be a constant of the same data type
  as the Object property specified by <i>a</i>.</span></p>
</td>
<td style="width:132.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">file:size &gt;= 33312</span></p>
</td>
</tr>
<tr>
<td style="width:98.25pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt" valign="top" width="131">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">IN</span><span lang="EN"> (<i>x</i>,<i>y</i>,...)</span></p>
</td>
<td style="width:241.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="322">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> <b>MUST</b> be
  an Object Path and <b>MUST</b> evaluate to one of the values enumerated in
  the set of x,y,... (transitive). The set values in <i>b</i> <b>MUST</b> be
  constants of homogeneous data type and <b>MUST</b> be valid data types for
  the Object Property specified by <i>a<b>. </b></i>The return value is true if
  <i>a</i> is equal to one of the values in the list. If <i>a</i> is not equal
  to any of the items in the list, then the Comparison Expression evaluates to
  false.</span></p>
</td>
<td style="width:132.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">process:name IN
  ('proccy', 'proximus', 'badproc')</span></p>
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;background:#CFE2F3"> </span></p>
</td>
</tr>
<tr>
<td style="width:98.25pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt" valign="top" width="131">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">LIKE</span><span lang="EN"> <i>b</i></span></p>
</td>
<td style="width:241.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="322">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> <b>MUST </b>be
  an Object Path and <b>MUST</b> match the pattern specified in <i>b</i> where
  any '%' is 0 or more characters and _' is any one character. </span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">This operator is based upon the SQL <i>LIKE</i>
  clause and makes use of the same wildcards.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">The string constant <i>b</i> <b>MUST</b> be
  NFC normalized [<a href="#kix.bpaod3mzj2ez"><span style="color:#1155CC">Davis</span></a>]
  prior to evaluation.</span></p>
</td>
<td style="width:132.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">directory:path LIKE
  'C:\\Windows\\%\\foo'</span></p>
</td>
</tr>
<tr>
<td style="width:98.25pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt" valign="top" width="131">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">MATCHES</span><span lang="EN"> <i>b</i></span></p>
</td>
<td style="width:241.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="322">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> <b>MUST</b> be
  an Object Path and <b>MUST</b> be matched by the pattern specified in <i>b,</i>
  where <i>b</i> is a string constant containing a PCRE compliant regular
  expression. <i>a</i> <b>MUST</b> be NFC normalized [<a href="#kix.bpaod3mzj2ez"><span style="color:#1155CC">Davis</span></a>] before
  comparison if the property is of string type.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">Regular expressions <b>MUST</b> be
  conformant to the syntax defined by the Perl-compatible Regular Expression
  (PCRE) library [<a href="#kix.x9xksgauq1r"><span style="color:#1155CC">PCRE</span></a>].<a href="http://www.pcre.org/original/doc/html/pcrepattern.html"><span style="color:windowtext;text-decoration:none"> The search function </span></a><a href="http://www.pcre.org/original/doc/html/pcrepattern.html"><b><span style="color:windowtext;text-decoration:none">MUST</span></b></a><a href="http://www.pcre.org/original/doc/html/pcrepattern.html"><span style="color:windowtext;text-decoration:none"> be used. The DOTALL option </span></a><a href="http://www.pcre.org/original/doc/html/pcrepattern.html"><b><span style="color:windowtext;text-decoration:none">MUST</span></b></a><a href="http://www.pcre.org/original/doc/html/pcrepattern.html"><span style="color:windowtext;text-decoration:none"> be specified. The standard
  beginning and end anchors may be used in the pattern to obtain match
  behavior.</span></a></span></p>
<p class="MsoNormal"><span lang="EN"><a href="http://www.pcre.org/original/doc/html/pcrepattern.html"><span style="color:windowtext;text-decoration:none"> </span></a></span></p>
<p class="MsoNormal"><span lang="EN"><a href="http://www.pcre.org/original/doc/html/pcrepattern.html"><span style="color:windowtext;text-decoration:none">In the case that the property
  is binary (e.g., the property name ends in </span></a><a href="http://www.pcre.org/original/doc/html/pcrepattern.html"><b><span style="color:windowtext;text-decoration:none">_bin</span></b></a><a href="http://www.pcre.org/original/doc/html/pcrepattern.html"><span style="color:windowtext;text-decoration:none"> or </span></a><a href="http://www.pcre.org/original/doc/html/pcrepattern.html"><b><span style="color:windowtext;text-decoration:none">_hex</span></b></a><a href="http://www.pcre.org/original/doc/html/pcrepattern.html"><span style="color:windowtext;text-decoration:none">), then the UNICODE flag </span></a><a href="http://www.pcre.org/original/doc/html/pcrepattern.html"><b><span style="color:windowtext;text-decoration:none">MUST NOT</span></b></a><a href="http://www.pcre.org/original/doc/html/pcrepattern.html"><span style="color:windowtext;text-decoration:none"> be specified.</span></a></span></p>
</td>
<td style="width:132.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">directory:path MATCHES
  '^C:\\\\Windows\\w+$'</span></p>
</td>
</tr>
<tr>
<td style="width:98.25pt;border:solid black 1.0pt;
  border-top:none;background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="131">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Set Operator</span></b></p>
</td>
<td style="width:241.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="322">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Description</span></b></p>
</td>
<td style="width:132.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="176">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Example</span></b></p>
</td>
</tr>
<tr>
<td style="width:98.25pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt" valign="top" width="131">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">ISSUBSET</span><span lang="EN"> <i>b</i></span></p>
</td>
<td style="width:241.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="322">
<p class="MsoNormal"><span lang="EN">When <i>a</i> is a set that is wholly
  contained by the set <i>b</i>, the Comparison Expression evaluates to true. <i>a</i>
<b>MUST</b> be an Object Path referring to the </span><b><span lang="EN" style="font-family:Consolas">value</span></b><span lang="EN"> property of an
  Object of type </span><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">ipv4-addr</span><span lang="EN"> or </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:#F9F2F4">ipv6-addr</span><span lang="EN">.<i> b</i> <b>MUST</b> be a valid </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:#F9F2F4">string</span><span lang="EN"> representation of the corresponding Object type (as defined in
  section <a href="#_mlbmudhl16lr"><span style="color:#1155CC">6</span></a>.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">For example, if </span><span lang="EN" style="font-size:9.0pt;line-height:115%;font-family:Consolas;color:black;
  background:#EFEFEF">ipv4-addr:value</span><span lang="EN"> was 198.51.100.0/27,
  </span><span lang="EN" style="font-size:9.0pt;line-height:115%;font-family:
  Consolas;color:black;background:#EFEFEF">ISSUBSET '198.51.100.0/24'</span><span lang="EN"> would evaluate to true.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">In the case that both <i>a</i> and <i>b</i>
  evaluate to an identical single IP address or an identical IP subnet, the
  Comparison Expression evaluates to true.</span></p>
</td>
<td style="width:132.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">ipv4-addr:value ISSUBSET
  '198.51.100.0/24'</span></p>
</td>
</tr>
<tr>
<td style="width:98.25pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt" valign="top" width="131">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">ISSUPERSET</span><span lang="EN"> <i>b</i></span></p>
</td>
<td style="width:241.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="322">
<p class="MsoNormal"><span lang="EN">When <i>a</i> is a set that wholly contains
  the set specified by <i>b</i>, the Comparison Expression evaluates to true. <i>a</i>
<b>MUST</b> be an Object Path referring either an </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:#F9F2F4">ipv4-addr</span><span lang="EN"> or </span><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">ipv6-addr</span><span lang="EN"> Object. <i>b</i> <b>MUST</b>
  be a valid </span><span lang="EN" style="font-family:Consolas;color:#C7254E;
  background:#F9F2F4">string</span><span lang="EN"> representation of the
  corresponding Object type (as defined in section <a href="#_mlbmudhl16lr"><span style="color:#1155CC">6</span></a>).</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">For example, if </span><span lang="EN" style="font-size:9.0pt;line-height:115%;font-family:Consolas;color:black;
  background:#EFEFEF">ipv4-addr:value</span><span lang="EN"> was 198.51.100.0/24,
  </span><span lang="EN" style="font-size:9.0pt;line-height:115%;font-family:
  Consolas;color:black;background:#EFEFEF">ISSUPERSET '198.51.100.0/27'</span><span lang="EN"> would evaluate to true.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">In the case that both <i>a</i> and <i>b</i>
  evaluate to an identical single IP address or an identical IP subnet, the
  Comparison Expression evaluates to true.</span></p>
</td>
<td style="width:132.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
  font-family:Consolas;color:black;background:#EFEFEF">ipv4-addr:value
  ISSUPERSET '198.51.100.0/24'</span></p>
</td>
</tr>
<tr>
<td style="width:98.25pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt" valign="top" width="131">
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#073763;
  background:#CFE2F3">EXISTS</span><span lang="EN"> <i>a</i></span></p>
</td>
<td style="width:241.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="322">
<p class="MsoNormal"><i><span lang="EN">a</span></i><span lang="EN"> <b>MUST</b> be
  an Object Path which specifies a single property that <b>MUST </b>exist on
  the Object specified by the Observation Expression in order for the
  Comparison Expression to evaluate to true.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">For example, EXISTS
  windows-registry-key:values would evaluate to true on a registry key that
  contains a 'values' property (regardless of its contents). </span></p>
</td>
<td style="width:132.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt" valign="top" width="176">
<p class="MsoNormal"><span lang="EN">EXISTS windows-registry-key:values</span></p>
</td>
</tr>
</table>
<p class="MsoNormal"><span lang="EN"> </span></p>
<h3><a name="_xpvr1dvwmijp"></a><span lang="EN">9.6.2 String Comparison</span></h3>
<p class="MsoNormal"><span lang="EN">For simple string operators, i.e., "</span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">=</span><span lang="EN">", "</span><span lang="EN" style="font-family:Consolas;
color:#073763;background:#CFE2F3">!=</span><span lang="EN">", "</span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">&lt;</span><span lang="EN">", "</span><span lang="EN" style="font-family:Consolas;
color:#073763;background:#CFE2F3">&gt;</span><span lang="EN">", "</span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">&lt;=</span><span lang="EN">" and "</span><span lang="EN" style="font-family:Consolas;
color:#073763;background:#CFE2F3">&gt;=</span><span lang="EN">", as
collation languages and methods are unspecifiable, a simple code point (binary)
comparison <b>MUST</b> be used. If one string is longer than the other, but
otherwise equal, the longer string is greater than, but not equal to, the
shorter string. Unicode normalization <b>MUST NOT</b> be performed on the
string. This means that combining marks [<a href="#kix.bpaod3mzj2ez"><span style="color:#1155CC">Davis</span></a>] are sorted by their code point, not the
NFC normalized value. E.g. o' U+006f &lt; oz' U+006f U+007a &lt; ò'
U+006f U+0300 &lt; z' U+007a &lt; ò' U+00f2. Although Unicode recommends
normalizing strings for comparisons, the use of combining marks may be
significant, and normalizing by default would remove this information.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">NFC normalization is, however, required for
other Comparison Operators, e.g., </span><span lang="EN" style="font-family:Consolas;
color:#073763;background:#CFE2F3">LIKE</span><span lang="EN"> and </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">MATCHES</span><span lang="EN">.</span></p>
<h3><a name="_hwcrgiy40ia0"></a><span lang="EN">9.6.3 Binary Type Comparison</span></h3>
<p class="MsoNormal"><span lang="EN">When the value of two binary object properties
are compared, they are compared as unsigned octets. That is, </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">00</span><span lang="EN"> is less than </span><span lang="EN" style="font-family:Consolas;
color:#073763;background:#CFE2F3">ff</span><span lang="EN">. If one value is
longer than the other, but they are otherwise equal, the longer value is
considered greater than, but not equal to, the shorter value.</span></p>
<h3><a name="_de6g573394q2"></a><span lang="EN">9.6.4 Native Format Comparison</span></h3>
<p class="MsoNormal"><span lang="EN">The SCO's value <b>MUST</b> be in its native
format when doing the comparison. For example, Cyber-observable Object
properties that use the </span><span lang="EN" style="font-family:Consolas;
color:#C7254E;background:#F9F2F4">binary</span><span lang="EN"> type (defined in
section <a href="#_63e0b9l81yx"><span style="color:#1155CC">2.1</span></a>)
must have their value decoded into its constituent bytes prior to comparison.
This also means that Object Properties which use the </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:#F9F2F4">hex</span><span lang="EN"> type must be decoded into raw octets prior to being evaluated.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">In cases where a binary SCO property (i.e.,
one ending with <b>_bin</b> or <b>_hex</b>) is evaluated against a string
constant, the string constant <b>MUST</b> be converted into a binary constant
when all of the constituent string code points are less than U+0100. If this
conversion is not possible, the comparison <b>MUST</b> evaluate to false,
unless the comparison operator is </span><span lang="EN" style="font-family:Consolas;
color:#073763;background:#CFE2F3">!=</span><span lang="EN">, in which case it <b>MUST
</b>evaluate to true.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">For example, given the following object, where
the <b>payload_bin</b> property is of </span><span lang="EN" style="font-family:
Consolas;color:#C7254E;background:#F9F2F4">binary</span><span lang="EN"> type :</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">{</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">  "0":{</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">    "type":
"artifact",</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">    "mime_type":
"application/octet-stream",</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">   
"payload_bin": "dGhpcyBpcyBhIHRlc3Q="</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">    }</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">}</span></p>
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;background:#CFE2F3"> </span></p>
<p class="MsoNormal"><span lang="EN">The pattern "</span><span lang="EN" style="font-size:9.0pt;line-height:115%;font-family:Consolas;color:black;
background:#EFEFEF">artifact:payload_bin = 'dGhpcyBpcyBhIHRlc3Q='</span><span lang="EN" style="font-family:Consolas">"</span><span lang="EN"> would evaluate
to false, while the following patterns would all evaluate to true:</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">"</span><span lang="EN" style="font-size:
9.0pt;line-height:115%;font-family:Consolas;color:black;background:#EFEFEF">artifact:payload_bin
= 'this is a test'</span><span lang="EN">", "</span><span lang="EN" style="font-size:9.0pt;line-height:115%;font-family:Consolas;color:black;
background:#EFEFEF">artifact:payload_bin = b'dGhpcyBpcyBhIHRlc3Q='</span><span lang="EN" style="font-family:Consolas">"</span><span lang="EN">,</span></p>
<p class="MsoNormal"><span lang="EN"> and "</span><span lang="EN" style="font-size:9.0pt;line-height:115%;font-family:Consolas;color:black;
background:#EFEFEF">artifact:payload_bin = h'7468697320697320612074657374'</span><span lang="EN">".</span></p>
<p class="MsoNormal"><span lang="EN">​</span></p>
<h2><a name="_i7kzkq2evwxj"></a><span lang="EN">9.7 Object Path Syntax</span></h2>
<p class="MsoNormal"><span lang="EN">Defined below is the syntax for addressing
properties of SCOs within a STIX Pattern. The following notation is used
throughout the definitions below:</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<table border="1" cellpadding="0" cellspacing="0" class="affffffd" style="border-collapse:collapse;border:none" width="582">
<tr>
<td style="width:136.5pt;border:solid black 1.0pt;
  background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="182">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Notation</span></b></p>
</td>
<td style="width:300.0pt;border:solid black 1.0pt;
  border-left:none;background:#073763;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="400">
<p class="MsoNormal"><b><span lang="EN" style="color:white">Definition</span></b></p>
</td>
</tr>
<tr>
<td style="width:136.5pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="182">
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#073763;
  background:#CFE2F3">&lt;object-type&gt;</span></p>
</td>
<td style="width:300.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="400">
<p class="MsoNormal"><span lang="EN">The type of SCO to match against. This <b>MUST
  </b>be the value of the <b>type </b>field specified for a given SCO in an
  Observation. </span></p>
</td>
</tr>
<tr>
<td style="width:136.5pt;border:solid black 1.0pt;
  border-top:none;padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="182">
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#073763;
  background:#CFE2F3">&lt;property_name&gt;</span></p>
</td>
<td style="width:300.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:5.0pt 5.0pt 5.0pt 5.0pt" valign="top" width="400">
<p class="MsoNormal"><span lang="EN">The name of a SCO property to match against.
  This <b>MUST </b>be<b> </b>a valid property name as specified in the
  definition of the SCO type referenced by the </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">&lt;object-type&gt;</span><span lang="EN"> notation.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">If the </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">&lt;property_name&gt;</span><span lang="EN"> contains a hyphen-minus ('-' U+002d) or a full stop ('.' U+002e),
  the </span><span lang="EN" style="font-family:Consolas;color:#073763;
  background:#CFE2F3">&lt;property_name&gt;</span><span lang="EN"> <b>MUST</b> be
  enclosed in apostrophes (''' U+0027).</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">Properties that are nested (i.e., are
  children of other properties in a SCO) <b>MUST</b> be specified using the
  syntax </span><span lang="EN" style="font-family:Consolas;color:#073763;
  background:#CFE2F3">&lt;property_name&gt;</span><span lang="EN">.</span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">&lt;property_name&gt;</span><span lang="EN">, where the </span><span lang="EN" style="font-family:Consolas;
  color:#073763;background:#CFE2F3">&lt;property_name&gt;</span><span lang="EN">
  preceding the .' is the name of the parent property and the one following is
  the name of the child property.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">If the property name is a reference to
  another SCO, the referenced Object <b>MUST</b> be dereferenced, so that its
  properties function as if they are nested in the Object that it is referenced
  by. For example, if the <b>src_ref</b> property of the Network Traffic object
  references an IPv4 Address object, the value of this IPv4 address would be
  specified by <b>network-traffic</b>:<b>src_ref.value</b>. </span></p>
<p class="MsoNormal"><b><span lang="EN"> </span></b></p>
<p class="MsoNormal"><b><span lang="EN">NOTE:</span></b><span lang="EN"> the STIX
  Patterning language currently does not support specifying and/or
  dereferencing top-level relationships between SCOs as part of its object
  syntax. Therefore, it is recommended to use the deprecated embedded
  relationships for this purpose, if necessary.</span></p>
</td>
</tr>
</table>
<p class="MsoNormal"><span lang="EN"> </span></p>
<h3><a name="_4e0vw4ysfuty"></a><span lang="EN">9.7.1 Basic Object Properties</span></h3>
<p class="MsoNormal"><span lang="EN">Any non-</span><span lang="EN" style="font-family:
Consolas;color:#C7254E;background:#F9F2F4">dictionary</span><span lang="EN"> and
non-</span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:
#F9F2F4">list</span><span lang="EN"> property that is directly specified on a
SCO.</span></p>
<p class="MsoNormal"><b><span lang="EN"> </span></b></p>
<p class="MsoNormal"><b><span lang="EN">Syntax</span></b></p>
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#073763;
background:#CFE2F3">&lt;object-type&gt;</span><span lang="EN" style='font-family:
"Courier New"'>:</span><span lang="EN" style="font-family:Consolas;color:#073763;
background:#CFE2F3">&lt;property_name&gt;</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><b><span lang="EN">Example</span></b></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">file:size</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<h3><a name="_tqad81km2lrm"></a><span lang="EN">9.7.2 List Object Properties</span></h3>
<p class="MsoNormal"><span lang="EN">Any property on a SCO that uses the </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:#F9F2F4">list</span><span lang="EN"> data type.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><b><span lang="EN">​Syntax</span></b></p>
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#073763;
background:#CFE2F3">&lt;object-type&gt;</span><span lang="EN" style='font-family:
"Courier New"'>:</span><span lang="EN" style="font-family:Consolas;color:#073763;
background:#CFE2F3">&lt;property_name&gt;[list_index]</span><span lang="EN" style='font-family:"Courier New"'>.</span><span lang="EN" style="font-family:
Consolas;color:#073763;background:#CFE2F3">&lt;property_name&gt;</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">Where the first </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">property_name</span><span lang="EN"> <b>MUST</b> be the name of an Object property of type </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:#F9F2F4">list</span><span lang="EN"> and </span><span lang="EN" style="font-family:Consolas;color:#073763;
background:#CFE2F3">list_index</span><b><span lang="EN"> MUST</span></b><span lang="EN"> be one of the following:</span></p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in"><span lang="EN">●<span style='font:7.0pt "Times New Roman"'>      </span></span><span lang="EN">An integer in the range of 0...N-1, where N is the length of the list.
If <i>list_index</i> is out of range, the result of any operation is false.</span></p>
<p class="MsoNormal" style="margin-left:.5in;text-indent:-.25in"><span lang="EN">●<span style='font:7.0pt "Times New Roman"'>      </span></span><span lang="EN" style="background:white">The literal '</span><span lang="EN" style="font-size:9.0pt;line-height:115%;font-family:Consolas;color:black;
background:#EFEFEF">*</span><span lang="EN" style="background:white">' indicates
that all of the items in the list shall be tried as a value to be evaluated
with the Comparison Operator and other value. If any of these evaluations are
true, then the result is true.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><b><span lang="EN">Examples</span></b></p>
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;background:#CFE2F3"> </span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">file:extensions.'windows-pebinary-ext'.sections[*].entropy</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;background:#EFEFEF"> </span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">network-traffic:protocols[0]</span></p>
<h3><a name="_ths0b11wzxv3"></a><span lang="EN">9.7.3 Dictionary Object
Properties</span></h3>
<p class="MsoNormal"><span lang="EN">Any property on an SCO that uses the </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:#F9F2F4">dictionary</span><span lang="EN"> data type.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><b><span lang="EN">​Syntax</span></b></p>
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#073763;
background:#CFE2F3">&lt;object-type&gt;</span><span lang="EN" style='font-family:
"Courier New"'>:</span><span lang="EN" style="font-family:Consolas;color:#073763;
background:#CFE2F3">&lt;property_name&gt;</span><span lang="EN" style='font-family:
"Courier New"'>.</span><span lang="EN" style="font-family:Consolas;color:#073763;
background:#CFE2F3">&lt;key_name&gt;</span></p>
<p class="MsoNormal"><span lang="EN" style='font-family:"Courier New";color:#38761D;
background:#D9EAD3'> </span></p>
<p class="MsoNormal"><span lang="EN">Where </span><span lang="EN" style="font-family:
Consolas;color:#073763;background:#CFE2F3">&lt;property_name&gt;</span><b><span lang="EN"> MUST</span></b><span lang="EN"> be the name of an Object property of
type </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:
#F9F2F4">dictionary</span><span lang="EN"> and </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">&lt;key_name&gt;</span><b><span lang="EN"> MUST </span></b><span lang="EN">be the name of key in the dictionary.</span></p>
<p class="MsoNormal"><b><span lang="EN"> </span></b></p>
<p class="MsoNormal"><b><span lang="EN">Examples</span></b></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">file:hashes.ssdeep</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;background:#EFEFEF"> </span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">file:extensions.'raster-image-ext'.image_height</span></p>
<h3><a name="_wech7thv41ee"></a><span lang="EN">9.7.4 Object Reference Properties</span></h3>
<p class="MsoNormal"><span lang="EN">Any property on an SCO that represents an
embedded relationship and uses the </span><span lang="EN" style="font-family:
Consolas;color:#C7254E;background:#F9F2F4">identifier</span><span lang="EN"> data
type, either as a singleton or as a list (i.e., </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:#F9F2F4">list</span><span lang="EN"> of type </span><span lang="EN" style="font-family:Consolas;color:#C7254E;
background:#F9F2F4">identifier</span><span lang="EN">).</span></p>
<p class="MsoNormal"><b><span lang="EN"> </span></b></p>
<p class="MsoNormal"><b><span lang="EN">​Syntax</span></b></p>
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#073763;
background:#CFE2F3">&lt;object-type&gt;</span><span lang="EN" style='font-family:
"Courier New"'>:</span><span lang="EN" style="font-family:Consolas;color:#073763;
background:#CFE2F3">&lt;property_name&gt;</span><span lang="EN">.</span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">&lt;dereferenced_object_property&gt;</span></p>
<p class="MsoNormal"><span lang="EN" style='font-family:"Courier New";color:#38761D;
background:#D9EAD3'> </span></p>
<p class="MsoNormal"><span lang="EN">Where </span><span lang="EN" style="font-family:
Consolas;color:#073763;background:#CFE2F3">&lt;property_name&gt;</span><b><span lang="EN"> MUST</span></b><span lang="EN"> be the name of an Object property that
represents an embedded relationships and is of type </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:#F9F2F4">identifier</span><span lang="EN"> and </span><span lang="EN" style="font-family:Consolas;color:#073763;
background:#CFE2F3">&lt;dereferenced_object_property&gt;</span><b><span lang="EN"> MUST </span></b><span lang="EN">be the name of a valid property of the
dereferenced Object (i.e., the Object in an Observation that is referenced via </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">&lt;property_name&gt;</span><span lang="EN">). </span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">For example, when processing the Observed Data
SDO that uses the </span><b><span lang="EN" style="font-family:Consolas">object_refs</span></b><span lang="EN"> property instead of the deprecated </span><b><span lang="EN" style="font-family:Consolas">objects</span></b><span lang="EN"> property, only
those SCO's that are listed in the </span><b><span lang="EN" style="font-family:
Consolas">object_refs</span></b><span lang="EN"> may be followed. This means that
if the object </span><span lang="EN" style="font-family:Consolas;color:#C7254E;
background:#F9F2F4">identifier</span><span lang="EN"> is not listed in </span><b><span lang="EN" style="font-family:Consolas">object_refs</span></b><span lang="EN">
property, then that object is considered not found, and any references to
properties of that object are considered not present.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><span lang="EN">For cases where </span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">&lt;property_name&gt;</span><span lang="EN"> represents a </span><span lang="EN" style="font-family:Consolas;
color:#C7254E;background:#F9F2F4">list</span><span lang="EN"> of embedded
relationships and is a </span><span lang="EN" style="font-family:Consolas;
color:#C7254E;background:#F9F2F4">list</span><span lang="EN"> of type </span><span lang="EN" style="font-family:Consolas;color:#C7254E;background:#F9F2F4">identifier</span><span lang="EN">, the corresponding syntax applies:</span></p>
<p class="MsoNormal"><span lang="EN" style="font-family:Consolas;color:#073763;
background:#CFE2F3">&lt;object-type&gt;</span><span lang="EN" style='font-family:
"Courier New"'>:</span><span lang="EN" style="font-family:Consolas;color:#073763;
background:#CFE2F3">&lt;property_name&gt;[list_index]</span><span lang="EN">.</span><span lang="EN" style="font-family:Consolas;color:#073763;background:#CFE2F3">&lt;dereferenced_object_property&gt;</span></p>
<p class="MsoNormal"><span lang="EN">Accordingly, the same semantics for list
indices as defined in section <a href="#_tqad81km2lrm"><span style="color:#1155CC">9.7.2</span></a>
apply in this case.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><b><span lang="EN">Examples</span></b></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">email-message:from_ref.value</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">directory:contains_refs[*].name</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<h2><a name="_alhyho8zsnmv"></a><span lang="EN">9.8 Examples</span></h2>
<p class="MsoNormal"><span lang="EN">Note: the examples below are <b>NOT</b> JSON
encoded. This means that some characters, like double quotes, are not escaped,
though they will be when encoded in a JSON string.</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><i><span lang="EN">Matching a File with a SHA-256 hash</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[file:hashes.'SHA-256' =
'aec070645fe53ee3b3763059376134f058cc337247c978add178b6ccdfb0019f']</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><i><span lang="EN">Matching an Email Message with a particular
From Email Address and Attachment File Name Using a Regular Expression</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[email-message:from_ref.value
MATCHES '.+\\@example\\.com$' AND email-message:body_multipart[*].body_raw_ref.name
MATCHES '^Final Report.+\\.exe$']</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><i><span lang="EN">Matching a File with a SHA-256 hash and a
PDF MIME type</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[file:hashes.'SHA-256' =
'aec070645fe53ee3b3763059376134f058cc337247c978add178b6ccdfb0019f' AND
file:mime_type = 'application/x-pdf']</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><i><span lang="EN">Matching a File with SHA-256 or a MD5 hash
(e.g., for the case of two different end point tools generating either an MD5
or a SHA-256), and a different File that has a different SHA-256 hash, against
two different Observations</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[file:hashes.'SHA-256' =
'bf07a7fbb825fc0aae7bf4a1177b2b31fcf8a3feeaf7092761e18c859ee52a9c' OR
file:hashes.MD5 = 'cead3f77f6cda6ec00f57d76c9a6879f']</span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF"> AND
[file:hashes.'SHA-256' = </span></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">'aec070645fe53ee3b3763059376134f058cc337247c978add178b6ccdfb0019f']</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><i><span lang="EN">Matching a File with a MD5 hash, followed
by (temporally) a Registry Key object that matches a value, within 5 minutes</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">([file:hashes.MD5 =
'79054025255fb1a26e4bc422aef54eb4'] FOLLOWEDBY [windows-registry-key:key =
'HKEY_LOCAL_MACHINE\\foo\\bar']) WITHIN 300 SECONDS</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><i><span lang="EN">Matching three different, but specific Unix
User Accounts</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[user-account:account_type
= 'unix' AND user-account:user_id = '1007' AND user-account:account_login =
'Peter'] AND [user-account:account_type = 'unix' AND user-account:user_id =
'1008' AND user-account:account_login = 'Paul'] AND [user-account:account_type
= 'unix' AND user-account:user_id = '1009' AND user-account:account_login =
'Mary']</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><i><span lang="EN">Matching an Artifact object PCAP payload
header</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[artifact:mime_type =
'application/vnd.tcpdump.pcap' AND artifact:payload_bin MATCHES
'\\xd4\\xc3\\xb2\\xa1\\x02\\x00\\x04\\x00']</span></p>
<p class="MsoNormal"><span lang="EN">​</span></p>
<p class="MsoNormal"><i><span lang="EN">Matching a File object with a Windows file
path</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[file:name = 'foo.dll' AND
file:parent_directory_ref.path = 'C:\\Windows\\System32'] </span></p>
<p class="MsoNormal"><span lang="EN">​</span></p>
<p class="MsoNormal"><i><span lang="EN">Matching on a Windows PE File with high
section entropy</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[file:extensions.'windows-pebinary-ext'.sections[*].entropy
&gt; 7.0]</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><i><span lang="EN">Matching on a mismatch between a File
object magic number and mime type</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[file:mime_type =
'image/bmp' AND file:magic_number_hex = h'ffd8']</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><i><span lang="EN">Matching on Network Traffic with a particular
destination</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[network-traffic:dst_ref.type
= 'ipv4-addr' AND network-traffic:dst_ref.value = '203.0.113.33/32'] </span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><i><span lang="EN">Matching on Malware Beaconing to a Domain
Name</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[network-traffic:dst_ref.type
= 'domain-name' AND network-traffic:dst_ref.value = 'example.com'] REPEATS 5
TIMES WITHIN 1800 SECONDS</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><i><span lang="EN">Matching on a Domain Name with IPv4
Resolution</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[domain-name:value =
'www.5z8.info' AND domain-name:resolves_to_refs[*].value = '198.51.100.1/32']</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><i><span lang="EN">Matching on a URL</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[url:value = 'http://example.com/foo'
OR url:value = 'http://example.com/bar']</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><i><span lang="EN">Matching on an X509 Certificate</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[x509-certificate:issuer =
'CN=WEBMAIL' AND x509-certificate:serial_number =
'4c:0b:1d:19:74:86:a7:66:b4:1a:bf:40:27:21:76:28']</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><i><span lang="EN">Matching on a Windows Registry Key</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[windows-registry-key:key
= 'HKEY_CURRENT_USER\\Software\\CryptoLocker\\Files' OR
windows-registry-key:key =
'HKEY_CURRENT_USER\\Software\\Microsoft\\CurrentVersion\\Run\\CryptoLocker_0388']</span></p>
<p class="MsoNormal"><span lang="EN">`</span></p>
<p class="MsoNormal"><i><span lang="EN">Matching on a File with a set of properties</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[(file:name = 'pdf.exe' OR
file:size = 371712) AND file:created = t'2014-01-13T07:03:17Z']</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><i><span lang="EN">Matching on an Email Message with specific
Sender and Subject</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[email-message:sender_ref.value
= 'jdoe@example.com' AND email-message:subject = 'Conference Info']</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><i><span lang="EN">Matching on a Custom USB Device</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[x-usb-device:usbdrive.serial_number
= '575833314133343231313937']</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><i><span lang="EN">Matching on Two Processes Launched with a
Specific Set of Command Line Arguments Within a Certain Time Window</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[process:command_line
MATCHES '^.+&gt;-add GlobalSign.cer -c -s -r localMachine Root$'] FOLLOWEDBY
[process:command_line MATCHES'^.+&gt;-add GlobalSign.cer -c -s -r
localMachineTrustedPublisher$'] WITHIN 300 SECONDS</span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><i><span lang="EN">Matching on a Network Traffic IP that is
part of a particular Subnet</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">[network-traffic:dst_ref.value
ISSUBSET '2001:0db8:dead:beef:0000:0000:0000:0000/64'] </span></p>
<p class="MsoNormal"><span lang="EN"> </span></p>
<p class="MsoNormal"><i><span lang="EN">Matching on several different combinations
of Malware Artifacts. Note the following pattern requires that both a file and
registry key exist, or that one of two processes exist.</span></i></p>
<p class="MsoNormal"><span lang="EN" style="font-size:9.0pt;line-height:115%;
font-family:Consolas;color:black;background:#EFEFEF">([file:name = 'foo.dll'] AND
[windows-registry-key:key = 'HKEY_LOCAL_MACHINE\\foo\\bar']) OR
[process:image_ref.name = 'fooproc' OR process:image_ref.name = 'procfoo']</span></p>
<span lang="EN" style='font-size:10.0pt;line-height:115%;font-family:"Arial",sans-serif'><br clear="all" style="page-break-before:always"/>
</span>
<p class="MsoNormal"><span lang="EN"> </span></p>
<div align="center" class="MsoNormal" style="text-align:center"><span lang="EN">
<hr align="center" size="2" width="100%"/>
</span></div>

</body>
</html>
